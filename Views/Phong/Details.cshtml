@model HotelManagement.Models.Phong
@{
    ViewData["Title"] = "Chi tiết phòng";
}

<h2 class="mb-4">@ViewData["Title"]</h2>

<div class="row g-3">
    <div class="col-md-4">
        <div class="border rounded-3 p-3 bg-light">
            <div class="text-muted">Mã phòng</div>
            <div class="fw-semibold fs-5">@Model.Id</div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="border rounded-3 p-3">
            <div class="text-muted">Tên phòng</div>
            <div class="fw-semibold fs-5">@Model.SoPhong</div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="border rounded-3 p-3">
            <div class="text-muted">Tình trạng</div>
            <span class="badge bg-@GetStatusColor(Model.TinhTrang)">@GetStatusLabel(Model.TinhTrang)</span>
        </div>
    </div>
    @{
        var loaiNames = ViewBag.LoaiPhongNames as System.Collections.Generic.Dictionary<int,string> ?? new System.Collections.Generic.Dictionary<int,string>();
        var loaiPrices = ViewBag.LoaiPhongPrices as System.Collections.Generic.Dictionary<int,decimal> ?? new System.Collections.Generic.Dictionary<int,decimal>();
        var tenLoai = Model.LoaiPhong?.TenLoaiPhong ?? (loaiNames.ContainsKey(Model.maLoaiPhong) ? loaiNames[Model.maLoaiPhong] : "-");
        var giaLoai = Model.LoaiPhong != null ? Model.LoaiPhong.GiaMoiDem : (loaiPrices.ContainsKey(Model.maLoaiPhong) ? loaiPrices[Model.maLoaiPhong] : 0m);
    }
    <div class="col-md-6">
        <div class="border rounded-3 p-3">
            <div class="text-muted">Loại phòng</div>
            <div class="fw-semibold fs-5">@tenLoai</div>
            <div class="text-muted">Giá: @giaLoai.ToString("N0") đ/đêm</div>
        </div>
    </div>
</div>

<div class="d-flex justify-content-between mt-4">
    <a asp-action="Index" class="btn btn-outline-secondary">
        <i class="bi bi-arrow-left-circle me-1"></i> Quay lại
    </a>
    <div class="d-flex gap-2">
        <a asp-action="Edit" asp-route-id="@Model.Id" class="btn btn-primary">
            <i class="bi bi-pencil-square me-1"></i> Sửa
        </a>
        <form asp-action="Delete" asp-route-id="@Model.Id" method="post" onsubmit="return confirm('Bạn có chắc muốn xóa phòng này?');">
            @Html.AntiForgeryToken()
            <button type="submit" class="btn btn-danger">
                <i class="bi bi-trash me-1"></i> Xóa
            </button>
        </form>
    </div>
</div>

@functions {
    private static string GetStatusLabel(string? status) => status switch
    {
        "DaDat" => "Đã đặt",
        "DangSuDung" => "Đang sử dụng",
        "DangSua" => "Đang sửa",
        _ => "Trống"
    };

    private static string GetStatusColor(string? status) => status switch
    {
        "DaDat" => "info",
        "DangSuDung" => "warning",
        "DangSua" => "secondary",
        _ => "success"
    };
}
